"use strict";
var util_1 = require('../../util');
var o = require('../operand');
var t = require('../table');
var table_1 = require('../../table');
var table_2 = require('../table');
exports.defaults = util_1.extend({}, t.defaults, { rex: false });
exports.table = util_1.extend({}, t.table, {
    mov: [{},
        { o: 0x88, ops: [table_2.rm8, table_2.rm8], dbit: true },
        { o: 0x89, ops: [table_2.rm16, table_2.rm16], dbit: true },
        { o: 0x89, ops: [table_2.rm32, table_2.rm32], dbit: true },
        { o: 0x89, ops: [table_2.rm64, table_2.rm64], dbit: true },
        { o: 0xB0, r: true, ops: [table_2.r8, table_1.imm8] },
        { o: 0xB8, r: true, ops: [table_2.r16, table_1.imm16] },
        { o: 0xB8, r: true, ops: [table_2.r32, table_1.imm32] },
        { o: 0xB8, r: true, ops: [table_2.r64, table_1.imm64] },
        { o: 0xC6, or: 0, ops: [table_2.rm8, table_1.imm8] },
        { o: 0xC7, or: 0, ops: [table_2.rm16, table_1.imm16] },
        { o: 0xC7, or: 0, ops: [table_2.rm32, table_1.imm32] },
        { o: 0xC7, or: 0, ops: [table_2.rm64, table_1.imm32] },
    ],
    push: [{ ds: table_1.S.Q, o: 0x50, r: true },
        { ops: [table_2.r64] },
        { ops: [table_2.r32] },
        { ops: [table_2.r16] },
    ],
    adcx: [{ o: 0x0F38F6, pfx: [0x66], ops: [table_2.r64, table_2.rm64] }],
    adox: [{ o: 0x0F38F6, pfx: [0xF3], ops: [table_2.r64, table_2.rm64] }],
    add: [{ lock: true },
        { o: 0x83, or: 0, ops: [table_2.rm64, table_1.imm8] },
        { o: 0x04, ops: [o.al, table_1.imm8], mr: false },
        { o: 0x05, ops: [o.ax, table_1.imm16], mr: false },
        { o: 0x05, ops: [o.eax, table_1.imm32], mr: false },
        { o: 0x05, ops: [o.rax, table_1.imm32], mr: false },
        { o: 0x80, or: 0, ops: [table_2.rm8, table_1.imm8] },
        { o: 0x83, or: 0, ops: [table_2.rm16, table_1.imm8] },
        { o: 0x81, or: 0, ops: [table_2.rm16, table_1.imm16] },
        { o: 0x83, or: 0, ops: [table_2.rm32, table_1.imm8] },
        { o: 0x81, or: 0, ops: [table_2.rm32, table_1.imm32] },
        { o: 0x81, or: 0, ops: [table_2.rm64, table_1.imm32] },
        { o: 0x00, ops: [table_2.rm8, table_2.rm8], dbit: true },
        { o: 0x01, ops: [table_2.rm16, table_2.rm16], dbit: true },
        { o: 0x01, ops: [table_2.rm32, table_2.rm32], dbit: true },
        { o: 0x01, ops: [table_2.rm64, table_2.rm64], dbit: true },
    ],
    adc: [{ lock: true },
        { o: 0x14, ops: [o.al, table_1.imm8] },
        { o: 0x15, ops: [o.ax, table_1.imm16] },
        { o: 0x15, ops: [o.eax, table_1.imm32] },
        { o: 0x15, ops: [o.rax, table_1.imm32] },
        { o: 0x80, or: 2, ops: [table_2.rm8, table_1.imm8] },
        { o: 0x81, or: 2, ops: [table_2.rm16, table_1.imm16] },
        { o: 0x81, or: 2, ops: [table_2.rm32, table_1.imm32] },
        { o: 0x81, or: 2, ops: [table_2.rm64, table_1.imm32] },
        { o: 0x83, or: 2, ops: [table_2.rm16, table_1.imm8] },
        { o: 0x83, or: 2, ops: [table_2.rm32, table_1.imm8] },
        { o: 0x83, or: 2, ops: [table_2.rm64, table_1.imm8] },
        { o: 0x10, ops: [table_2.rm8, table_2.rm8], dbit: true },
        { o: 0x11, ops: [table_2.rm16, table_2.rm16], dbit: true },
        { o: 0x11, ops: [table_2.rm32, table_2.rm32], dbit: true },
        { o: 0x11, ops: [table_2.rm64, table_2.rm64], dbit: true },
    ],
    sub: [{ lock: true },
        { o: 0x2C, ops: [o.al, table_1.imm8] },
        { o: 0x2D, ops: [o.ax, table_1.imm16] },
        { o: 0x2D, ops: [o.eax, table_1.imm32] },
        { o: 0x2D, ops: [o.rax, table_1.imm32] },
        { o: 0x80, or: 5, ops: [table_2.rm8, table_1.imm8] },
        { o: 0x83, or: 5, ops: [table_2.rm16, table_1.imm8] },
        { o: 0x81, or: 5, ops: [table_2.rm16, table_1.imm16] },
        { o: 0x83, or: 5, ops: [table_2.rm32, table_1.imm8] },
        { o: 0x81, or: 5, ops: [table_2.rm32, table_1.imm32] },
        { o: 0x83, or: 5, ops: [table_2.rm64, table_1.imm8] },
        { o: 0x81, or: 5, ops: [table_2.rm64, table_1.imm32] },
        { o: 0x28, ops: [table_2.rm8, table_2.rm8], dbit: true },
        { o: 0x29, ops: [table_2.rm16, table_2.rm16], dbit: true },
        { o: 0x29, ops: [table_2.rm32, table_2.rm32], dbit: true },
        { o: 0x29, ops: [table_2.rm64, table_2.rm64], dbit: true },
    ],
    sbb: [{ lock: true },
        { o: 0x1C, ops: [o.al, table_1.imm8] },
        { o: 0x1D, ops: [o.ax, table_1.imm16] },
        { o: 0x1D, ops: [o.eax, table_1.imm32] },
        { o: 0x1D, ops: [o.rax, table_1.imm32] },
        { o: 0x80, or: 3, ops: [table_2.rm8, table_1.imm8] },
        { o: 0x83, or: 3, ops: [table_2.rm16, table_1.imm8] },
        { o: 0x81, or: 3, ops: [table_2.rm16, table_1.imm16] },
        { o: 0x83, or: 3, ops: [table_2.rm32, table_1.imm8] },
        { o: 0x81, or: 3, ops: [table_2.rm32, table_1.imm32] },
        { o: 0x83, or: 3, ops: [table_2.rm64, table_1.imm8] },
        { o: 0x81, or: 3, ops: [table_2.rm64, table_1.imm64] },
        { o: 0x18, ops: [table_2.rm8, table_2.r8], dbit: true },
        { o: 0x19, ops: [table_2.rm16, table_2.r16], dbit: true },
        { o: 0x19, ops: [table_2.rm32, table_2.r32], dbit: true },
        { o: 0x19, ops: [table_2.rm64, table_2.r64], dbit: true },
    ],
    imul: [{},
        { o: 0xF6, or: 5, ops: [table_2.rm8] },
        { o: 0xF7, or: 5, ops: [table_2.rm16] },
        { o: 0xF7, or: 5, ops: [table_2.rm32] },
        { o: 0xF7, or: 5, ops: [table_2.rm64] },
        { o: 0x0FAF, ops: [table_2.r16, table_2.rm16] },
        { o: 0x0FAF, ops: [table_2.r32, table_2.rm32] },
        { o: 0x0FAF, ops: [table_2.r64, table_2.rm64] },
        { o: 0x6B, ops: [table_2.r16, table_2.rm16, table_1.imm8] },
        { o: 0x6B, ops: [table_2.r32, table_2.rm32, table_1.imm8] },
        { o: 0x6B, ops: [table_2.r64, table_2.rm64, table_1.imm8] },
        { o: 0x69, ops: [table_2.r16, table_2.rm16, table_1.imm16] },
        { o: 0x69, ops: [table_2.r32, table_2.rm32, table_1.imm32] },
        { o: 0x69, ops: [table_2.r64, table_2.rm64, table_1.imm32] },
    ],
    mul: [{ o: 0xF7, or: 4 },
        { o: 0xF6, ops: [table_2.rm8] },
        { ops: [table_2.rm16] },
        { ops: [table_2.rm32] },
        { ops: [table_2.rm64] },
    ],
    idiv: [{},
        { o: 0xF6, or: 7, ops: [table_2.rm8] },
        { o: 0xF7, or: 7, ops: [table_2.rm16] },
        { o: 0xF7, or: 7, ops: [table_2.rm32] },
        { o: 0xF7, or: 7, ops: [table_2.rm64] },
    ],
    div: [{ o: 0xF7, or: 6 },
        { o: 0xF6, ops: [table_2.rm8] },
        { ops: [table_2.rm16] },
        { ops: [table_2.rm32] },
        { ops: [table_2.rm64] },
    ],
    inc: [{ o: 0xFF, or: 0, lock: true },
        { o: 0xFE, ops: [table_2.rm8] },
        { ops: [table_2.rm16] },
        { ops: [table_2.rm32] },
        { ops: [table_2.rm64] },
    ],
    dec: [{ or: 1, lock: true },
        { o: 0xFE, ops: [table_2.rm8] },
        { o: 0xFF, ops: [table_2.rm16] },
        { o: 0xFF, ops: [table_2.rm32] },
        { o: 0xFF, ops: [table_2.rm64] },
    ],
    neg: [{ or: 3, lock: true },
        { o: 0xF6, ops: [table_2.rm8] },
        { o: 0xF7, ops: [table_2.rm16] },
        { o: 0xF7, ops: [table_2.rm32] },
        { o: 0xF7, ops: [table_2.rm64] },
    ],
    cmp: [{},
        { o: 0x3C, ops: [o.al, table_1.imm8], mr: false },
        { o: 0x3D, ops: [o.ax, table_1.imm16], mr: false },
        { o: 0x3D, ops: [o.eax, table_1.imm32], mr: false },
        { o: 0x3D, ops: [o.rax, table_1.imm32], mr: false },
        { o: 0x80, or: 7, ops: [table_2.rm8, table_1.imm8] },
        { o: 0x83, or: 7, ops: [table_2.rm16, table_1.imm8] },
        { o: 0x81, or: 7, ops: [table_2.rm16, table_1.imm16] },
        { o: 0x83, or: 7, ops: [table_2.rm32, table_1.imm8] },
        { o: 0x81, or: 7, ops: [table_2.rm32, table_1.imm32] },
        { o: 0x83, or: 7, ops: [table_2.rm64, table_1.imm8] },
        { o: 0x81, or: 7, ops: [table_2.rm64, table_1.imm32] },
        { o: 0x38, ops: [table_2.rm8, table_2.rm8] },
        { o: 0x39, ops: [table_2.rm16, table_2.rm16] },
        { o: 0x39, ops: [table_2.rm32, table_2.rm32] },
        { o: 0x39, ops: [table_2.rm64, table_2.rm64] },
    ],
    jmp: [{ ds: table_1.S.Q },
        { o: 0xEB, ops: [table_1.rel8] },
        { o: 0xE9, ops: [table_1.rel32] },
        { o: 0xFF, or: 4, ops: [table_2.rm64] },
    ],
    ljmp: [{ ds: table_1.S.Q },
        { o: 0xFF, or: 5, ops: [table_2.m], s: table_1.S.Q },
    ],
    jecxz: [{ o: 0xE3, ops: [table_1.rel8], pfx: [0x67] }],
    jrcxz: [{ o: 0xE3, ops: [table_1.rel8] }],
    ja: [{},
        { o: 0x77, ops: [table_1.rel8] },
        { o: 0x0F87, ops: [table_1.rel32] },
    ],
    jae: [{},
        { o: 0x73, ops: [table_1.rel8] },
        { o: 0x0F83, ops: [table_1.rel32] },
    ],
    jb: [{},
        { o: 0x72, ops: [table_1.rel8] },
        { o: 0x0F82, ops: [table_1.rel32] },
    ],
    jbe: [{},
        { o: 0x76, ops: [table_1.rel8] },
        { o: 0x0F86, ops: [table_1.rel32] },
    ],
    jc: [{},
        { o: 0x72, ops: [table_1.rel8] },
        { o: 0x0F82, ops: [table_1.rel32] },
    ],
    je: [{},
        { o: 0x74, ops: [table_1.rel8] },
        { o: 0x0F84, ops: [table_1.rel32] },
    ],
    jg: [{},
        { o: 0x7F, ops: [table_1.rel8] },
        { o: 0x0F8F, ops: [table_1.rel32] },
    ],
    jge: [{},
        { o: 0x7D, ops: [table_1.rel8] },
        { o: 0x0F8D, ops: [table_1.rel32] },
    ],
    jl: [{},
        { o: 0x7C, ops: [table_1.rel8] },
        { o: 0x0F8C, ops: [table_1.rel32] },
    ],
    jle: [{},
        { o: 0x7E, ops: [table_1.rel8] },
        { o: 0x0F8E, ops: [table_1.rel32] },
    ],
    jna: [{},
        { o: 0x76, ops: [table_1.rel8] },
        { o: 0x0F86, ops: [table_1.rel32] },
    ],
    jnae: [{},
        { o: 0x72, ops: [table_1.rel8] },
        { o: 0x0F82, ops: [table_1.rel32] },
    ],
    jnb: [{},
        { o: 0x73, ops: [table_1.rel8] },
        { o: 0x0F83, ops: [table_1.rel32] },
    ],
    jnbe: [{},
        { o: 0x77, ops: [table_1.rel8] },
        { o: 0x0F87, ops: [table_1.rel32] },
    ],
    jnc: [{},
        { o: 0x73, ops: [table_1.rel8] },
        { o: 0x0F83, ops: [table_1.rel32] },
    ],
    jne: [{},
        { o: 0x75, ops: [table_1.rel8] },
        { o: 0x0F85, ops: [table_1.rel32] },
    ],
    jng: [{},
        { o: 0x7E, ops: [table_1.rel8] },
        { o: 0x0F8E, ops: [table_1.rel32] },
    ],
    jnge: [{},
        { o: 0x7C, ops: [table_1.rel8] },
        { o: 0x0F8C, ops: [table_1.rel32] },
    ],
    jnl: [{},
        { o: 0x7D, ops: [table_1.rel8] },
        { o: 0x0F8D, ops: [table_1.rel32] },
    ],
    jnle: [{},
        { o: 0x7F, ops: [table_1.rel8] },
        { o: 0x0F8F, ops: [table_1.rel32] },
    ],
    jno: [{},
        { o: 0x71, ops: [table_1.rel8] },
        { o: 0x0F81, ops: [table_1.rel32] },
    ],
    jnp: [{},
        { o: 0x7B, ops: [table_1.rel8] },
        { o: 0x0F8B, ops: [table_1.rel32] },
    ],
    jns: [{},
        { o: 0x79, ops: [table_1.rel8] },
        { o: 0x0F89, ops: [table_1.rel32] },
    ],
    jnz: [{},
        { o: 0x75, ops: [table_1.rel8] },
        { o: 0x0F85, ops: [table_1.rel32] },
    ],
    jo: [{},
        { o: 0x70, ops: [table_1.rel8] },
        { o: 0x0F80, ops: [table_1.rel32] },
    ],
    jp: [{},
        { o: 0x7A, ops: [table_1.rel8] },
        { o: 0x0F8A, ops: [table_1.rel32] },
    ],
    jpe: [{},
        { o: 0x7A, ops: [table_1.rel8] },
        { o: 0x0F8A, ops: [table_1.rel32] },
    ],
    jpo: [{},
        { o: 0x7B, ops: [table_1.rel8] },
        { o: 0x0F8B, ops: [table_1.rel32] },
    ],
    js: [{},
        { o: 0x78, ops: [table_1.rel8] },
        { o: 0x0F88, ops: [table_1.rel32] },
    ],
    jz: [{},
        { o: 0x74, ops: [table_1.rel8] },
        { o: 0x0F84, ops: [table_1.rel32] },
    ],
    loop: [{ o: 0xE2, ops: [table_1.rel8] }],
    loope: [{ o: 0xE1, ops: [table_1.rel8], mns: ['loopz'] }],
    loopne: [{ o: 0xE0, ops: [table_1.rel8], mns: ['loopnz'] }],
    call: [{ ds: table_1.S.Q },
        { o: 0xE8, ops: [table_1.rel32] },
        { o: 0xFF, or: 2, ops: [table_2.rm64] },
    ],
    lcall: [{ ds: table_1.S.Q },
        { o: 0xFF, or: 3, ops: [table_2.m], s: table_1.S.Q },
    ],
    ret: [{ ds: table_1.S.Q },
        { o: 0xC3 },
        { o: 0xC2, ops: [table_1.imm16] }
    ],
    lret: [{ ds: table_1.S.Q },
        { o: 0xCB },
        { o: 0xCA, ops: [table_1.imm16] }
    ],
    iret: [{ o: 0xCF }
    ],
    'in': [{ mr: false },
        { o: 0xE4, ops: [o.al, table_1.imm8] },
        { o: 0xE5, ops: [o.ax, table_1.imm8] },
        { o: 0xE5, ops: [o.eax, table_1.imm8] },
        { o: 0xEC, ops: [o.al, o.dx], s: table_1.S.B },
        { o: 0xED, ops: [o.ax, o.dx], s: table_1.S.W },
        { o: 0xED, ops: [o.eax, o.dx], s: table_1.S.D },
    ],
    out: [{ mr: false },
        { o: 0xE6, ops: [table_1.imm8, o.al] },
        { o: 0xE7, ops: [table_1.imm8, o.ax] },
        { o: 0xE7, ops: [table_1.imm8, o.eax] },
        { o: 0xEE, ops: [o.dx, o.al], s: table_1.S.B },
        { o: 0xEF, ops: [o.dx, o.ax], s: table_1.S.W },
        { o: 0xEF, ops: [o.dx, o.eax], s: table_1.S.D },
    ],
    ins: [{ o: 0x6D },
        { o: 0x6C, s: table_1.S.B },
        { s: table_1.S.W },
        { s: table_1.S.D },
    ],
    outs: [{ o: 0x6F },
        { o: 0x6E, s: table_1.S.B },
        { s: table_1.S.W },
        { s: table_1.S.D },
    ],
    enter: [{},
        { o: 0xC8, ops: [table_1.imm16, table_1.imm8] },
    ],
    leave: [{ o: 0xC9 },
        { s: table_1.S.W },
        { s: table_1.S.Q },
    ],
    stc: [{ o: 0xF9 }],
    clc: [{ o: 0xF8 }],
    cmc: [{ o: 0xF5 }],
    cld: [{ o: 0xFC }],
    std: [{ o: 0xFD }],
    pushf: [{ o: 0x9C }],
    popf: [{ o: 0x9D }],
    sti: [{ o: 0xFB }],
    cli: [{ o: 0xFA }],
    lea: [{ o: 0x8D },
        { ops: [table_2.r64, table_2.m] },
        { ops: [table_2.r32, table_2.m] },
        { ops: [table_2.r16, table_2.m] },
    ],
    nop: [{},
        { o: 0x90 },
        { o: 0x0F1F, or: 0, ops: [table_2.rm16] },
        { o: 0x0F1F, or: 0, ops: [table_2.rm32] },
    ],
    rdrand: [{ o: 0x0FC7, or: 6 },
        { ops: [table_2.r16] },
        { ops: [table_2.r32] },
        { ops: [table_2.r64] },
    ],
    rdseed: [{ o: 0x0FC7, or: 7 },
        { ops: [table_2.r16] },
        { ops: [table_2.r32] },
        { ops: [table_2.r64] },
    ],
    syscall: [{ o: 0x0F05 }],
    sysret: [{ o: 0x0F07 }],
    sysenter: [{ o: 0x0F34 }],
    sysexit: [{ o: 0x0F35 }],
});
